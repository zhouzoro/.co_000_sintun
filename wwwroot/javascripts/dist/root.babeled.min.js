"use strict";function login(){var t=new FormData($("form#login")[0]);xhr.send(t)}function updatePage(t){var e=$($(t).data("form"));tinymce.activeEditor.uploadImages(function(t){var a=new XMLHttpRequest;a.open("POST","/cruiser_reports"),a.onload=function(){var t=JSON.parse(a.responseText);"200"==t.status?showTipMsg("更新"+e.find("input[name=type]")+"成功",1):"504"==t.status&&showTipMsg("更新失败: "+t.msg,0)};var n=tinymce.activeEditor.save(),i=new FormData(e[0]);i.append("html",n),a.send(i)})}function uploadPost(t){var e=$(t);tinymce.activeEditor.uploadImages(function(t){var a=new XMLHttpRequest;a.open("POST","/news"),a.onload=function(){var t=JSON.parse(a.responseText);"200"==t.status?window.location=t.url:"504"==t.status&&showTipMsg("上传失败: "+t.msg,0)};var n=tinymce.activeEditor.save();e.find("input[name=content]").val(n);var i=new FormData(e[0]);a.send(i)})}function updatePost(t){tinymce.activeEditor.uploadImages(function(e){var a=$(t),n=new XMLHttpRequest;n.open(a.attr("method"),a.attr("action")),n.onload=function(){console.log(n.responseText);var t=JSON.parse(n.responseText);"200"==t.status?window.location=t.url:"504"==t.status&&showTipMsg("上传失败: "+t.msg,0)};var i=tinymce.activeEditor.save();$("input[name=content]").val(i);var o=new FormData(a[0]);o.append("username",Cookies.get("username")),o.append("email",Cookies.get("email")),n.send(o)})}function initMce(t,e){tinymce.init({selector:t,skin:"mxc1",language:"zh_CN",content_css:"/stylesheets/dist/travelogue.min.css",body_class:"travelogue",plugins:["autoresize","advlist","autolink","lists","link","image","charmap","print","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","paste","imagetools"],toolbar:"undo redo styleselect fontsizeselect bold italic underline alignleft aligncenter alignright alignfull advlist lists link",image_caption:!0,paste_data_images:!0,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 14pt 18pt 24pt",menubar:!1,images_upload_url:"/upload/images",statusbar:!1,min_height:480,max_height:640,setup:function(t){t.on("change",function(e){var a=t.save();$("input[name=content]").val(a).change()}),t.on("init",function(t){$("input[name=content]").val()&&tinymce.activeEditor.setContent($("input[name=content]").val()),$("input[name=cover]").val()&&$(".post-hero").css({background:'url("http://'+window.location.host+$("input[name=cover]").val()+'")',"background-size":"cover"}),!window.location.host.lastIndexOf("edit")})}})}function uploadPic(){var t=$(this).next("img"),e=$(this).find("#pic-loader"),a=$(this).find("label"),n=$("<input>").attr({type:"file","class":"temp-input"}).css({display:"none",position:"absolute"}).change(function(){if(this.files&&this.files[0]){var n=new FileReader;n.onload=function(e){t.attr("src",e.target.result)},n.readAsDataURL(this.files[0]),a.removeClass("btn").addClass("pct");var i=function(t){var n=Math.ceil(100*t.loaded/t.total),i=100-n;e.css({height:i+"px"}),a.text(n+"%")},o=new XMLHttpRequest;o.withCredentials=!1,o.open("POST","/images"),o.onload=function(){var e=JSON.parse(o.responseText);console.log(e.location),t.attr("src",e.location),a.removeClass("pct").addClass("btn").text("change"),$(".temp-input").remove()},o.upload.addEventListener("progress",i,!1);var s=new FormData;s.append("image",this.files[0],this.files[0].name),o.send(s)}});$("body").append(n),n.click()}function computProgress(t){var e=Math.ceil(1e3*t.loaded/t.total)/10+"%";return e}function GetCurrentDate(){var t=new Date,e=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getFullYear()+"-"+e+"-"+t.getDate();return a}$(document).ready(function(){function t(){var t=this,e=$(t).next(".result");$.get("http://api.geonames.org/searchJSON?lang=ZH&username=zhouzoro&maxRows=10&q="+$(t).val(),function(t){e.empty(),0===t.geonames.length&&e.append("No Results Found");var a=!0,n=!1,i=void 0;try{for(var o,s=t.geonames[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var r=o.value,c=$("<li>").attr("class","geoname-resultlist-item"),l=$("<a>").attr("data-id",r.geonameId).append($("<span>").attr("class","name").text(r.name)).append($("<span>").attr("class","toponymName").text("("+r.toponymName+")"));r.countryName&&""!==r.countryName&&l.append($("<span>").attr("class","countryName").text(", "+r.countryName)).append($("<span>").attr("class","toponymName").text("("+r.toponymName+")")),e.append(c.append(l))}}catch(p){n=!0,i=p}finally{try{!a&&s["return"]&&s["return"]()}finally{if(n)throw i}}})}$(".ui.accordion").accordion(),$(".ui.menu .item").tab(),initMce("#input-body"),$("a.item.edit-page").click(function(){initMce("#mce-input"+$(this).data("tab"))}),$("#btn-img").click(function(){var t=$("<input>").attr({type:"file","class":"temp-input"}).css({display:"none",position:"absolute"}).change(function(){if(this.files&&this.files[0]){var t=new FileReader;t.onload=function(t){tinymce.activeEditor.execCommand("insertHTML",!1,'<img class="inline-img" src="'+t.target.result+'" width="100%" >'),tinymce.activeEditor.uploadImages()},t.readAsDataURL(this.files[0])}$(".temp-input").remove()});$("body").append(t),t.click()});$(".geosearch").keyup(t).change(t)}),$(".add-btn").click(function(){var t=$("<div>").attr("class","expand-transition");$(this).append(t);var e=$(this).data("url"),a=$(this).data("type");$.get(e,function(e){$("#modal-cust").find(".container").html(e),$("#btn-cancel").click(function(){$("#body").show(),$("#modal-cust").hide("fast"),$("#modal-cust").find(".container").html("")}),$("#modal-cust").show("slow"),$("#body").hide("slow"),initUploadOf(a),t.remove(),$("#edit-pic").click(uploadPic)})});
//# sourceMappingURL=D:/Documents/GitHub/.co_000_sintun/wwwroot/javascripts/maps/root.babeled.min.js.map
