{"version":3,"sources":["root.babeled.min.js","root.babeled.js"],"names":["uploadImg","editorId","tempImgInput","$","attr","type","class","css","display","position","change","this","files","reader","FileReader","onload","e","tinymce","get","insertContent","target","result","uploadImages","removeClass","readAsDataURL","addClass","remove","append","click","login","form","xhr","XMLHttpRequest","open","res","JSON","parse","responseText","status","showTipMsg","msg","find","hide","html","accordion","tab","each","initMce","window","scroll","showScrollTop","changeToolBarPosition","resize","formData","FormData","send","updatePage","formSelector","uploadPost","updatePass","location","url","replaceImg","el","btn","ops","parent","img","prev","data","background","background-size","fileUploadReq","withCredentials","name","val","deleteImg","deleteWithId","uploadPi","json","newImgContainer","pid","fname","href","data-name","data-id","id","data-url","onclick","text","download","activeEditor","success","contentHtml","save","openInNewTab","console","log","$a","deleteNews","nid","$item","setTimeout","deleteProducts","loadToT","mce","undoDelete","item","show","txt","isok","color","border","selector","imgurl","init","skin","language","content_css","body_class","plugins","toolbar","image_caption","paste_data_images","fontsize_formats","menubar","relative_urls","images_upload_url","statusbar","min_height","max_height","setup","ed","on","newProduct","modal","uploadPic","next","loader","label","updateProgress","oEvent","pct","Math","ceil","loaded","total","height","upload","addEventListener","checkVisible","elm","evalType","vpH","st","scrollTop","y","offset","top","elementHeight","indi","ScrollTop","body","stop","animate"],"mappings":"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","file":"root.babeled.min.js","sourcesContent":["'use strict';\n\nfunction uploadImg(editorId) {\n    var tempImgInput = $('<input>').attr({\n        'type': 'file',\n        'class': 'temp-input'\n    }).css({\n        'display': 'none',\n        'position': 'absolute'\n    }).change(function () {\n        if (this.files && this.files[0]) {\n            var reader = new FileReader();\n            reader.onload = function (e) {\n                tinymce.get(editorId).insertContent('<img class=\"inline-img\" src=\"' + e.target.result + '\" width=\"100%\" >');\n\n                tinymce.get(editorId).uploadImages();\n                $('.loader').removeClass('loading');\n            };\n            reader.readAsDataURL(this.files[0]);\n            $('.loader').addClass('loading');\n        }\n\n        $('.temp-input').remove();\n    });\n    $('body').append(tempImgInput);\n    tempImgInput.click();\n}\n\nfunction login() {\n    $('.loader').addClass('loading');\n    var form = $('form#login');\n    var xhr = new XMLHttpRequest();\n    xhr.open(form.attr('method'), form.attr('action'));\n\n    xhr.onload = function () {\n        $('.loader').removeClass('loading');\n        var res = JSON.parse(xhr.responseText);\n        if (res.status == '504') {\n            showTipMsg('登录失败: ' + res.msg, 0);\n        } else {\n            showTipMsg('登录成功: ' + res.msg, 1);\n            $('.main').find('.login-page').hide();\n            $('.main').find('#control-panel').remove();\n            $('.main').append(res.html);\n\n            $('.ui.accordion').accordion();\n            $('.ui.menu .item').tab();\n            $('.frm-body .input-body').each(function () {\n                initMce('#' + $(this).attr('id'));\n            });\n            $(window).scroll(function () {\n                showScrollTop();\n                changeToolBarPosition();\n            });\n            $(window).resize(changeToolBarPosition);\n        }\n    };\n    var formData = new FormData(form[0]);\n    xhr.send(formData);\n}\n\nfunction updatePage(formSelector) {\n    uploadPost(formSelector);\n}\n\nfunction updatePass() {\n    $('.loader').addClass('loading');\n    var form = $('#frm-secu');\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', '/update_pass');\n\n    xhr.onload = function () {\n        var res = JSON.parse(xhr.responseText);\n        if (res.status == '200') {\n            window.location = res.url;\n        } else if (res.status == '504') {\n            $('.loader').removeClass('loading');\n            showTipMsg('更新密码失败: ' + res.msg, 0);\n        }\n    };\n    var formData = new FormData(form[0]);\n    xhr.send(formData);\n}\n\nfunction replaceImg(el) {\n    var btn = $(el);\n    var ops = btn.parent('.ops');\n    var img = ops.prev('img');\n    var tempImgInput = $('<input>').attr({\n        'type': 'file',\n        'class': 'temp-input'\n    }).css({\n        'display': 'none',\n        'position': 'absolute'\n    }).change(function () {\n        $('.loader').addClass('loading');\n        if (this.files && this.files[0]) {\n            var reader = new FileReader();\n            reader.onload = function (e) {\n                img.attr('src', e.target.result);\n                if (btn.data('name') == \"hb.jpg\") {\n                    $('header').css('background', 'url(\"/images/default-bg.jpg\")');\n                    $('header').css({\n                        'background': 'url(\"' + e.target.result + '\")',\n                        'background-size': 'cover'\n                    });\n                }\n            };\n            reader.readAsDataURL(this.files[0]);\n\n            var fileUploadReq = new XMLHttpRequest();\n            fileUploadReq.withCredentials = false;\n            fileUploadReq.open('POST', btn.data('url'));\n\n            fileUploadReq.onload = function () {\n                $('.loader').removeClass('loading');\n                tempImgInput.remove();\n            };\n\n            var formData = new FormData();\n            formData.append('image', this.files[0], this.files[0].name);\n            formData.append('fname', btn.data('name'));\n            formData.append('name', $('input[name=name]').val());\n            formData.append('password', $('input[name=password]').val());\n            fileUploadReq.send(formData);\n        }\n    });\n    $('body').append(tempImgInput);\n    tempImgInput.click();\n}\n\nfunction deleteImg(el) {\n    $('.loader').addClass('loading');\n    var btn = $(el);\n    deleteWithId(btn.data(url));\n    btn.parent('.img-container').remove();\n}\n\nfunction deleteWithId(url) {\n\n    var form = $('form#login');\n    var xhr = new XMLHttpRequest();\n    xhr.open(form.attr('method'), url);\n\n    var formData = new FormData(form[0]);\n    xhr.send(formData);\n}\n\nfunction uploadPi(el) {\n    var btn = $(el);\n    var tempImgInput = $('<input>').attr({\n        'type': 'file',\n        'class': 'temp-input'\n    }).css({\n        'display': 'none',\n        'position': 'absolute'\n    }).change(function () {\n        $('.loader').addClass('loading');\n        if (this.files && this.files[0]) {\n\n            var fileUploadReq = new XMLHttpRequest();\n            fileUploadReq.withCredentials = false;\n            fileUploadReq.open('POST', '/upload/images/products/' + btn.data('pid'));\n\n            fileUploadReq.onload = function () {\n                var json = JSON.parse(fileUploadReq.responseText);\n                var newImgContainer = $('<div>').attr('class', 'col-xs-3 col-sm-3 col-md-3 col-lg-3 img-container');\n                var img = $('<div>').attr('class', 'img').append($('<img>').attr('src', '/images/products/' + json.pid + '/' + json.fname));\n                var ops = $('<div>').attr('class', 'ops').append($('<a>').attr({\n                    \"class\": \"red\",\n                    \"href\": \"#\",\n                    \"data-name\": json.fname,\n                    \"data-id\": json.id,\n                    \"data-url\": \"/delete_imgs/\" + json.id,\n                    \"onclick\": \"deleteImg(this)\"\n                }).text('删除')).append($('<a>').attr({\n                    \"href\": \"#\",\n                    \"data-name\": json.fname,\n                    \"data-url\": \"/upload/images/products/\" + json.pid,\n                    \"onclick\": \"replaceImg(this)\"\n                }).text('替换')).append($('<a>').attr({\n                    \"href\": '/images/products/' + json.pid + '/' + json.fname,\n                    \"download\": json.fname\n                }).text('下载'));\n                $('.rearange.ps').append(newImgContainer.append(img.append(ops)));\n                $('.loader').removeClass('loading');\n                tempImgInput.remove();\n            };\n\n            var formData = new FormData();\n            formData.append('image', this.files[0], this.files[0].name);\n            formData.append('name', $('input[name=name]').val());\n            formData.append('password', $('input[name=password]').val());\n            fileUploadReq.send(formData);\n        }\n    });\n    $('body').append(tempImgInput);\n    tempImgInput.click();\n}\n\nfunction uploadPost(formSelector) {\n    $('.loader').addClass('loading');\n    var form = $(formSelector);\n\n    tinymce.activeEditor.uploadImages(function (success) {\n        var xhr = new XMLHttpRequest();\n        xhr.open(form.attr('method'), form.attr('action'));\n\n        xhr.onload = function () {\n            var res = JSON.parse(xhr.responseText);\n            if (res.status == '200') {\n                if (formSelector === '#frm-product') {\n                    $('a.item.pimg-tab').click();\n                    $('.loader').removeClass('loading');\n                } else {\n                    window.location = res.url;\n                }\n            } else if (res.status == '504') {\n                $('.loader').removeClass('loading');\n                showTipMsg('上传失败: ' + res.msg, 0);\n            }\n        };\n\n        var contentHtml = tinymce.activeEditor.save();\n        form.find('input[name=content]').val(contentHtml);\n        var formData = new FormData(form[0]);\n        xhr.send(formData);\n    });\n}\n\nfunction openInNewTab(url) {\n    console.log(1);\n    var $a = $('<a>').attr({\n        'href': url,\n        'class': 'hidden',\n        'target': '__blank'\n    });\n    $('body').append($a);\n    $a.click();\n}\n\nfunction deleteNews(nid) {\n    var $item = $('#it' + nid);\n    $item.find('*').hide();\n    var $a = $('<a>').attr({\n        'class': 'revoke-delete',\n        'onclick': 'undoDelete(\"#it' + nid + '\")'\n    }).append($('<i>').attr('class', 'fa fa-undo')).append('<span>取消</span>');\n    $item.append($a).append('<span class=\"revoke-delete date\">已删除</span>');\n    window.setTimeout(function () {\n        if ($item.find(\".revoke-delete\")[0]) {\n            $item.remove();\n            deleteWithId('/delete_news/' + nid);\n        }\n    }, 2400);\n}\n\nfunction deleteProducts(pid) {\n    var $item = $('#pit' + pid);\n    $item.find('*').hide();\n    var $a = $('<a>').attr({\n        'class': 'revoke-delete',\n        'onclick': 'undoDelete(\"#pit' + pid + '\")'\n    }).append($('<i>').attr('class', 'fa fa-undo')).append('<span>取消</span>');\n\n    $item.append($a).append('<span class=\"revoke-delete date\">已删除</span>');\n    window.setTimeout(function () {\n        if ($item.find(\".revoke-delete\")[0]) {\n            $item.remove();\n            deleteWithId('/delete_products/' + pid);\n        }\n    }, 2400);\n}\n\nfunction loadToT(url) {\n    $('.loader').addClass('loading');\n    $.get(url, function (res) {\n        $('.ui.tab.active').removeClass('active');\n        $('.ui.tab.temp').html(res).addClass('active');\n        $('.ui.tab.temp').find('form').each(function () {\n            var form = $(this);\n            var mce = form.find('.input-body');\n            initMce('#' + mce.attr('id'));\n        });\n    });\n}\n\nfunction undoDelete(item) {\n    var $item = $(item);\n    $item.find(\".revoke-delete\").remove();\n    $item.find('*').show();\n}\n\nfunction showTipMsg(txt, isok) {\n    var color = isok ? 'green' : 'red';\n    $('p.tip-message').text(txt).css({\n        'background': isok ? 'rgba(55,222,88,0.3)' : 'rgba(222,55,88,0.3)',\n        'color': color,\n        'border': '1px solid ' + color\n    });\n}\n\nfunction initMce(selector) {\n    $('.loader').addClass('loading');\n    var imgurl = $(selector).data('imgurl');\n    if (!imgurl) imgurl = '/upload/images';\n    tinymce.init({\n        selector: selector,\n        skin: 'mxc1',\n        language: 'zh_CN',\n        content_css: '/stylesheets/dist/travelogue.min.css',\n        body_class: 'travelogue',\n        plugins: [\"autoresize\", \"advlist\", \"autolink\", \"lists\", \"link\", \"image\", \"charmap\", \"print\", \"preview\", \"anchor\", \"searchreplace\", \"visualblocks\", \"code\", \"fullscreen\", \"insertdatetime\", \"media\", \"table\", \"paste\", \"imagetools\"],\n        toolbar: 'undo redo styleselect fontsizeselect bold italic underline alignleft aligncenter alignright alignfull advlist lists link',\n        image_caption: true,\n        paste_data_images: true,\n        //block_formats: 'Paragraph=p;Header 1=h1;Header 2=h2;Header 3=h3',\n        fontsize_formats: '8pt 9pt 10pt 11pt 12pt 14pt 18pt 24pt',\n        //plugins: \"contextmenu\",\n        //contextmenu: \"formatselect bold italic link image inserttable | cell row column deletetable\",\n        menubar: false,\n        relative_urls: false,\n        images_upload_url: imgurl,\n        statusbar: false,\n        min_height: 480,\n        max_height: 640,\n\n        setup: function setup(ed) {\n            ed.on('change', function (e) {\n                var contentHtml = ed.save();\n                $('input[name=content]').val(contentHtml).change();\n            });\n            ed.on('init', function (e) {\n                $('.loader').removeClass('loading');\n            });\n        }\n    });\n}\n\nfunction newProduct() {\n    $.get('/new_product', function (res) {\n        var modal = $('.cust-modal');\n        modal.html(res.html);\n        $('.menu.tab-product .item').tab();\n        initMce('#mce-product');\n        modal.removeClass('out');\n    });\n}\n\nfunction uploadPic() {\n    var img = $(this).next('img');\n    var loader = $(this).find('#pic-loader');\n    var label = $(this).find('label');\n    var tempImgInput = $('<input>').attr({\n        'type': 'file',\n        'class': 'temp-input'\n    }).css({\n        'display': 'none',\n        'position': 'absolute'\n    }).change(function () {\n        if (this.files && this.files[0]) {\n            var reader = new FileReader();\n            reader.onload = function (e) {\n                img.attr('src', e.target.result);\n            };\n            reader.readAsDataURL(this.files[0]);\n            label.removeClass('btn').addClass('pct');\n            var updateProgress = function updateProgress(oEvent) {\n                var pct = Math.ceil(100 * oEvent.loaded / oEvent.total);\n                var height = 100 - pct;\n                loader.css({ 'height': height + 'px' });\n                label.text(pct + '%');\n            };\n            var fileUploadReq = new XMLHttpRequest();\n            fileUploadReq.withCredentials = false;\n            fileUploadReq.open('POST', '/images');\n\n            fileUploadReq.onload = function () {\n                var json = JSON.parse(fileUploadReq.responseText);\n                console.log(json.location);\n                img.attr('src', json.location);\n                label.removeClass('pct').addClass('btn').text('change');\n                $('.temp-input').remove();\n            };\n            fileUploadReq.upload.addEventListener(\"progress\", updateProgress, false);\n            var formData = new FormData();\n            formData.append('image', this.files[0], this.files[0].name);\n            fileUploadReq.send(formData);\n        }\n    });\n    $('body').append(tempImgInput);\n    tempImgInput.click();\n}\n\nfunction checkVisible(elm, evalType) {\n    evalType = evalType || 'visible';\n\n    var vpH = $(window).height();\n    // Viewport Height\n    var st = $(window).scrollTop();\n\n    // Scroll Top\n    var y = $(elm).offset().top;\n    var elementHeight = $(elm).height();\n\n    if (evalType === 'visible') return y < vpH + st && y > st - elementHeight;\n    if (evalType === 'above') return y < vpH + st;\n}\n\nfunction showScrollTop() {\n    if (!checkVisible($('#top-indicator'))) {\n        $('#scroll-top').removeClass(\"out\").addClass(\"in\");\n    } else {\n        $('#scroll-top').removeClass(\"in\").addClass(\"out\");\n    }\n}\n\nfunction changeToolBarPosition() {\n    $('.bottom-indicator').each(function () {\n        var indi = $(this);\n        var ops = $(this).prev('.ops');\n        if (!checkVisible(indi)) {\n            ops.addClass('sticky');\n        } else {\n\n            ops.removeClass('sticky');\n        }\n    });\n}\n\nfunction ScrollTop() {\n    var body = $(\"html, body\");\n    body.stop().animate({\n        scrollTop: 0\n    }, '400');\n}","function uploadImg(editorId) {\r\n    var tempImgInput = $('<input>').attr({\r\n        'type': 'file',\r\n        'class': 'temp-input'\r\n    }).css({\r\n        'display': 'none',\r\n        'position': 'absolute'\r\n    }).change(function() {\r\n        if (this.files && this.files[0]) {\r\n            var reader = new FileReader();\r\n            reader.onload = function(e) {\r\n                tinymce.get(editorId).insertContent('<img class=\"inline-img\" src=\"' + e.target.result + '\" width=\"100%\" >');\r\n\r\n                tinymce.get(editorId).uploadImages();\r\n                $('.loader').removeClass('loading');\r\n            };\r\n            reader.readAsDataURL(this.files[0]);\r\n            $('.loader').addClass('loading');\r\n        }\r\n\r\n        $('.temp-input').remove();\r\n    });\r\n    $('body').append(tempImgInput);\r\n    tempImgInput.click();\r\n}\r\n\r\nfunction login() {\r\n    $('.loader').addClass('loading');\r\n    var form = $('form#login');\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(form.attr('method'), form.attr('action'));\r\n\r\n    xhr.onload = function() {\r\n        $('.loader').removeClass('loading');\r\n        var res = JSON.parse(xhr.responseText);\r\n        if (res.status == '504') {\r\n            showTipMsg('登录失败: ' + res.msg, 0);\r\n        } else {\r\n            showTipMsg('登录成功: ' + res.msg, 1);\r\n            $('.main').find('.login-page').hide();\r\n            $('.main').find('#control-panel').remove();\r\n            $('.main').append(res.html);\r\n\r\n            $('.ui.accordion').accordion();\r\n            $('.ui.menu .item').tab();\r\n            $('.frm-body .input-body').each(function() {\r\n                initMce('#' + $(this).attr('id'));\r\n            })\r\n            $(window).scroll(function() {\r\n                showScrollTop();\r\n                changeToolBarPosition();\r\n            });\r\n            $(window).resize(changeToolBarPosition);\r\n        }\r\n    };\r\n    var formData = new FormData(form[0]);\r\n    xhr.send(formData);\r\n}\r\n\r\nfunction updatePage(formSelector) {\r\n    uploadPost(formSelector);\r\n}\r\n\r\nfunction updatePass() {\r\n    $('.loader').addClass('loading');\r\n    var form = $('#frm-secu');\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('POST', '/update_pass');\r\n\r\n    xhr.onload = function() {\r\n        var res = JSON.parse(xhr.responseText);\r\n        if (res.status == '200') {\r\n            window.location = res.url;\r\n        } else if (res.status == '504') {\r\n            $('.loader').removeClass('loading');\r\n            showTipMsg('更新密码失败: ' + res.msg, 0);\r\n        }\r\n    };\r\n    var formData = new FormData(form[0]);\r\n    xhr.send(formData);\r\n}\r\n\r\nfunction replaceImg(el) {\r\n    var btn = $(el);\r\n    var ops = btn.parent('.ops');\r\n    var img = ops.prev('img');\r\n    var tempImgInput = $('<input>').attr({\r\n        'type': 'file',\r\n        'class': 'temp-input'\r\n    }).css({\r\n        'display': 'none',\r\n        'position': 'absolute'\r\n    }).change(function() {\r\n        $('.loader').addClass('loading');\r\n        if (this.files && this.files[0]) {\r\n            var reader = new FileReader();\r\n            reader.onload = function(e) {\r\n                img.attr('src', e.target.result);\r\n                if (btn.data('name') == \"hb.jpg\") {\r\n                    $('header').css('background', 'url(\"/images/default-bg.jpg\")');\r\n                    $('header').css({\r\n                        'background': 'url(\"' + e.target.result + '\")',\r\n                        'background-size': 'cover'\r\n                    });\r\n                }\r\n            };\r\n            reader.readAsDataURL(this.files[0]);\r\n\r\n            var fileUploadReq = new XMLHttpRequest();\r\n            fileUploadReq.withCredentials = false;\r\n            fileUploadReq.open('POST', btn.data('url'));\r\n\r\n            fileUploadReq.onload = function() {\r\n                $('.loader').removeClass('loading');\r\n                tempImgInput.remove();\r\n            };\r\n\r\n            var formData = new FormData();\r\n            formData.append('image', this.files[0], this.files[0].name);\r\n            formData.append('fname', btn.data('name'));\r\n            formData.append('name', $('input[name=name]').val());\r\n            formData.append('password', $('input[name=password]').val());\r\n            fileUploadReq.send(formData);\r\n        }\r\n    });\r\n    $('body').append(tempImgInput);\r\n    tempImgInput.click();\r\n\r\n}\r\n\r\nfunction deleteImg(el) {\r\n    $('.loader').addClass('loading');\r\n    var btn = $(el);\r\n    deleteWithId(btn.data(url));\r\n    btn.parent('.img-container').remove();\r\n}\r\n\r\nfunction deleteWithId(url) {\r\n\r\n    var form = $('form#login');\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(form.attr('method'), url);\r\n\r\n    var formData = new FormData(form[0]);\r\n    xhr.send(formData);\r\n\r\n}\r\n\r\nfunction uploadPi(el) {\r\n    var btn = $(el);\r\n    var tempImgInput = $('<input>').attr({\r\n        'type': 'file',\r\n        'class': 'temp-input'\r\n    }).css({\r\n        'display': 'none',\r\n        'position': 'absolute'\r\n    }).change(function() {\r\n        $('.loader').addClass('loading');\r\n        if (this.files && this.files[0]) {\r\n\r\n            var fileUploadReq = new XMLHttpRequest();\r\n            fileUploadReq.withCredentials = false;\r\n            fileUploadReq.open('POST', '/upload/images/products/' + btn.data('pid'));\r\n\r\n            fileUploadReq.onload = function() {\r\n                var json = JSON.parse(fileUploadReq.responseText);\r\n                var newImgContainer = $('<div>').attr('class', 'col-xs-3 col-sm-3 col-md-3 col-lg-3 img-container');\r\n                var img = $('<div>').attr('class', 'img').append($('<img>').attr('src', '/images/products/' + json.pid + '/' + json.fname));\r\n                var ops = $('<div>').attr('class', 'ops')\r\n                    .append($('<a>').attr({\r\n                        \"class\": \"red\",\r\n                        \"href\": \"#\",\r\n                        \"data-name\": json.fname,\r\n                        \"data-id\": json.id,\r\n                        \"data-url\": \"/delete_imgs/\" + json.id,\r\n                        \"onclick\": \"deleteImg(this)\"\r\n                    }).text('删除'))\r\n                    .append($('<a>').attr({\r\n                        \"href\": \"#\",\r\n                        \"data-name\": json.fname,\r\n                        \"data-url\": \"/upload/images/products/\" + json.pid,\r\n                        \"onclick\": \"replaceImg(this)\"\r\n                    }).text('替换'))\r\n                    .append($('<a>').attr({\r\n                        \"href\": '/images/products/' + json.pid + '/' + json.fname,\r\n                        \"download\": json.fname\r\n                    }).text('下载'));\r\n                $('.rearange.ps').append(newImgContainer.append(img.append(ops)))\r\n                $('.loader').removeClass('loading');\r\n                tempImgInput.remove();\r\n            };\r\n\r\n            var formData = new FormData();\r\n            formData.append('image', this.files[0], this.files[0].name);\r\n            formData.append('name', $('input[name=name]').val());\r\n            formData.append('password', $('input[name=password]').val());\r\n            fileUploadReq.send(formData);\r\n        }\r\n    });\r\n    $('body').append(tempImgInput);\r\n    tempImgInput.click();\r\n}\r\n\r\nfunction uploadPost(formSelector) {\r\n    $('.loader').addClass('loading');\r\n    var form = $(formSelector);\r\n\r\n    tinymce.activeEditor.uploadImages(function(success) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(form.attr('method'), form.attr('action'));\r\n\r\n        xhr.onload = function() {\r\n            var res = JSON.parse(xhr.responseText);\r\n            if (res.status == '200') {\r\n                if (formSelector === '#frm-product') {\r\n                    $('a.item.pimg-tab').click();\r\n                    $('.loader').removeClass('loading');\r\n                } else {\r\n                    window.location = res.url;\r\n                }\r\n\r\n            } else if (res.status == '504') {\r\n                $('.loader').removeClass('loading');\r\n                showTipMsg('上传失败: ' + res.msg, 0);\r\n            }\r\n        };\r\n\r\n        var contentHtml = tinymce.activeEditor.save();\r\n        form.find('input[name=content]').val(contentHtml);\r\n        var formData = new FormData(form[0]);\r\n        xhr.send(formData);\r\n    });\r\n}\r\n\r\nfunction openInNewTab(url) {\r\n    console.log(1);\r\n    var $a = $('<a>').attr({\r\n        'href': url,\r\n        'class': 'hidden',\r\n        'target': '__blank'\r\n    });\r\n    $('body').append($a);\r\n    $a.click();\r\n}\r\n\r\nfunction deleteNews(nid) {\r\n    var $item = $('#it' + nid);\r\n    $item.find('*').hide();\r\n    var $a = $('<a>').attr({\r\n            'class': 'revoke-delete',\r\n            'onclick': 'undoDelete(\"#it' + nid + '\")'\r\n        })\r\n        .append($('<i>').attr('class', 'fa fa-undo'))\r\n        .append('<span>取消</span>');\r\n    $item.append($a).append('<span class=\"revoke-delete date\">已删除</span>');\r\n    window.setTimeout(function() {\r\n        if ($item.find(\".revoke-delete\")[0]) {\r\n            $item.remove();\r\n            deleteWithId('/delete_news/' + nid);\r\n        }\r\n    }, 2400)\r\n}\r\n\r\nfunction deleteProducts(pid) {\r\n    var $item = $('#pit' + pid);\r\n    $item.find('*').hide();\r\n    var $a = $('<a>').attr({\r\n            'class': 'revoke-delete',\r\n            'onclick': 'undoDelete(\"#pit' + pid + '\")'\r\n        })\r\n        .append($('<i>').attr('class', 'fa fa-undo'))\r\n        .append('<span>取消</span>');\r\n\r\n    $item.append($a).append('<span class=\"revoke-delete date\">已删除</span>');\r\n    window.setTimeout(function() {\r\n        if ($item.find(\".revoke-delete\")[0]) {\r\n            $item.remove();\r\n            deleteWithId('/delete_products/' + pid);\r\n        }\r\n    }, 2400)\r\n}\r\n\r\nfunction loadToT(url) {\r\n    $('.loader').addClass('loading');\r\n    $.get(url, function(res) {\r\n        $('.ui.tab.active').removeClass('active');\r\n        $('.ui.tab.temp').html(res).addClass('active');\r\n        $('.ui.tab.temp').find('form').each(function() {\r\n            var form = $(this);\r\n            var mce = form.find('.input-body');\r\n            initMce('#' + mce.attr('id'));\r\n        })\r\n    })\r\n}\r\n\r\n\r\nfunction undoDelete(item) {\r\n    var $item = $(item);\r\n    $item.find(\".revoke-delete\").remove();\r\n    $item.find('*').show();\r\n}\r\n\r\n\r\nfunction showTipMsg(txt, isok) {\r\n    var color = isok ? 'green' : 'red';\r\n    $('p.tip-message').text(txt).css({\r\n        'background': isok ? 'rgba(55,222,88,0.3)' : 'rgba(222,55,88,0.3)',\r\n        'color': color,\r\n        'border': '1px solid ' + color\r\n    });\r\n}\r\n\r\nfunction initMce(selector) {\r\n    $('.loader').addClass('loading');\r\n    var imgurl = $(selector).data('imgurl');\r\n    if (!imgurl) imgurl = '/upload/images';\r\n    tinymce.init({\r\n        selector: selector,\r\n        skin: 'mxc1',\r\n        language: 'zh_CN',\r\n        content_css: '/stylesheets/dist/travelogue.min.css',\r\n        body_class: 'travelogue',\r\n        plugins: [\"autoresize\", \"advlist\", \"autolink\", \"lists\", \"link\", \"image\", \"charmap\", \"print\", \"preview\", \"anchor\", \"searchreplace\", \"visualblocks\", \"code\", \"fullscreen\", \"insertdatetime\", \"media\", \"table\", \"paste\", \"imagetools\"],\r\n        toolbar: 'undo redo styleselect fontsizeselect bold italic underline alignleft aligncenter alignright alignfull advlist lists link',\r\n        image_caption: true,\r\n        paste_data_images: true,\r\n        //block_formats: 'Paragraph=p;Header 1=h1;Header 2=h2;Header 3=h3',\r\n        fontsize_formats: '8pt 9pt 10pt 11pt 12pt 14pt 18pt 24pt',\r\n        //plugins: \"contextmenu\",\r\n        //contextmenu: \"formatselect bold italic link image inserttable | cell row column deletetable\",\r\n        menubar: false,\r\n        relative_urls: false,\r\n        images_upload_url: imgurl,\r\n        statusbar: false,\r\n        min_height: 480,\r\n        max_height: 640,\r\n\r\n        setup: function(ed) {\r\n            ed.on('change', function(e) {\r\n                var contentHtml = ed.save();\r\n                $('input[name=content]').val(contentHtml).change();\r\n            });\r\n            ed.on('init', function(e) {\r\n                $('.loader').removeClass('loading');\r\n\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nfunction newProduct() {\r\n    $.get('/new_product', function(res) {\r\n        var modal = $('.cust-modal');\r\n        modal.html(res.html);\r\n        $('.menu.tab-product .item')\r\n            .tab();\r\n        initMce('#mce-product');\r\n        modal.removeClass('out');\r\n    })\r\n}\r\n\r\nfunction uploadPic() {\r\n    var img = $(this).next('img');\r\n    var loader = $(this).find('#pic-loader');\r\n    var label = $(this).find('label');\r\n    var tempImgInput = $('<input>').attr({\r\n        'type': 'file',\r\n        'class': 'temp-input'\r\n    }).css({\r\n        'display': 'none',\r\n        'position': 'absolute'\r\n    }).change(function() {\r\n        if (this.files && this.files[0]) {\r\n            var reader = new FileReader();\r\n            reader.onload = function(e) {\r\n                img.attr('src', e.target.result);\r\n            };\r\n            reader.readAsDataURL(this.files[0]);\r\n            label.removeClass('btn').addClass('pct');\r\n            var updateProgress = function updateProgress(oEvent) {\r\n                var pct = Math.ceil(100 * oEvent.loaded / oEvent.total);\r\n                var height = 100 - pct;\r\n                loader.css({ 'height': height + 'px' });\r\n                label.text(pct + '%');\r\n            };\r\n            var fileUploadReq = new XMLHttpRequest();\r\n            fileUploadReq.withCredentials = false;\r\n            fileUploadReq.open('POST', '/images');\r\n\r\n            fileUploadReq.onload = function() {\r\n                var json = JSON.parse(fileUploadReq.responseText);\r\n                console.log(json.location);\r\n                img.attr('src', json.location);\r\n                label.removeClass('pct').addClass('btn').text('change');\r\n                $('.temp-input').remove();\r\n            };\r\n            fileUploadReq.upload.addEventListener(\"progress\", updateProgress, false);\r\n            var formData = new FormData();\r\n            formData.append('image', this.files[0], this.files[0].name);\r\n            fileUploadReq.send(formData);\r\n        }\r\n    });\r\n    $('body').append(tempImgInput);\r\n    tempImgInput.click();\r\n}\r\n\r\nfunction checkVisible(elm, evalType) {\r\n    evalType = evalType || 'visible';\r\n\r\n    var vpH = $(window).height();\r\n    // Viewport Height\r\n    var st = $(window).scrollTop();\r\n\r\n    // Scroll Top\r\n    var y = $(elm).offset().top;\r\n    var elementHeight = $(elm).height();\r\n\r\n    if (evalType === 'visible') return y < vpH + st && y > st - elementHeight;\r\n    if (evalType === 'above') return y < vpH + st;\r\n}\r\n\r\nfunction showScrollTop() {\r\n    if (!checkVisible($('#top-indicator'))) {\r\n        $('#scroll-top').removeClass(\"out\").addClass(\"in\");\r\n    } else {\r\n        $('#scroll-top').removeClass(\"in\").addClass(\"out\");\r\n    }\r\n}\r\n\r\nfunction changeToolBarPosition() {\r\n    $('.bottom-indicator').each(function() {\r\n        var indi = $(this);\r\n        var ops = $(this).prev('.ops');\r\n        if (!checkVisible(indi)) {\r\n            ops.addClass('sticky');\r\n        } else {\r\n\r\n            ops.removeClass('sticky');\r\n        }\r\n    })\r\n}\r\n\r\nfunction ScrollTop() {\r\n    var body = $(\"html, body\");\r\n    body.stop().animate({\r\n        scrollTop: 0\r\n    }, '400');\r\n}\r\n"],"sourceRoot":"/source/"}